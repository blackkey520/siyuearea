webpackJsonp([3],{226:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(289),u=r(n),s=a(221),i=r(s),c=a(10),o=r(c);a(290);var d=a(3610),l=a(2352),m=a(3),p=r(m),f=a(144),g=(a(60),a(104));t.default={namespace:"message",state:{messagedetail:{},commentlist:[],messagelist:[],checkcommunity:{},communitylist:[],pagination:{current:1,pageSize:10,total:0}},reducers:{updateState:function(e,t){var a=t.payload;return(0,o.default)({},e,a)},loaddataSuccess:function(e,t){var a=t.payload.data;return(0,o.default)({},e,{memberlist:a.data.record,pagination:{current:t.payload.current,pageSize:t.payload.pageSize,total:a.data.totalRecord||0}})}},subscriptions:{},effects:{getcommentlist:i.default.mark(function e(t,a){var r,n,u,s,c=(t.payload,a.call),o=a.select,m=a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(function(e){return e.message});case 2:return r=e.sent,n=r.messagedetail,e.next=6,c(d.getcommentlist,{msgid:n.msgid});case 6:return u=e.sent,s=u.data,s.map(function(e,t){e.level=l.mlevel[e.mpd],e.comtime=(0,p.default)(e.comtime).fromNow()}),e.next=11,m({type:"updateState",payload:{commentlist:s}});case 11:case"end":return e.stop()}},e,this)}),exquisite:i.default.mark(function e(t,a){var r,n=t.payload,u=a.call,s=(a.select,a.put);return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(d.exquisitemessage,{msgid:n.msgid});case 2:return r=e.sent,e.next=5,s(f.routerRedux.push({pathname:"/discus"}));case 5:case"end":return e.stop()}},e,this)}),delcomment:i.default.mark(function e(t,a){var r,n=t.payload,u=a.call,s=(a.select,a.put);return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(d.delcomment,{comid:n.comid});case 2:return r=e.sent,e.next=5,s({type:"getcommentlist",payload:{}});case 5:case"end":return e.stop()}},e,this)}),delmessage:i.default.mark(function e(t,a){var r,n=t.payload,u=a.call,s=(a.select,a.put);return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(d.delmessage,{msgid:n.msgid});case 2:return r=e.sent,e.next=5,s(f.routerRedux.push({pathname:"/discus"}));case 5:case"end":return e.stop()}},e,this)}),getcommunitylist:i.default.mark(function e(t,a){var r,n=(t.payload,a.call),u=(a.select,a.put);return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(d.querycommunitylist,{});case 2:if(r=e.sent,!r.success||0===r.data.record.length){e.next=6;break}return e.next=6,u({type:"updateState",payload:{communitylist:r.data.record,pagination:{current:1,pageSize:10,total:0}}});case 6:case"end":return e.stop()}},e,this)}),addcommunity:i.default.mark(function e(t,a){var r=t.payload,n=a.call,s=(a.out,a.put);a.select;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.communityid){e.next=5;break}return e.next=3,n(d.updatecommunity,(0,o.default)({},r));case 3:e.next=7;break;case 5:return e.next=7,n(d.addcommunity,(0,o.default)({},r));case 7:return u.default.success("保存成功"),e.next=10,s(f.routerRedux.push({pathname:"/discus"}));case 10:case"end":return e.stop()}},e,this)}),getmessagelist:i.default.mark(function e(t,a){var r,n,u,s,c,m,f,g=t.payload,y=a.call,h=a.select,v=a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(function(e){return e.message});case 2:return r=e.sent,n=r.messagelist,u=r.pagination,e.next=7,y(d.getmessagelist,(0,o.default)({},g,{likemid:-1}));case 7:if(s=e.sent,!s.success||0===s.data.record.length){e.next=18;break}return c=[],m=g.page,f=s.data.record,f.map(function(e,t){e.msgimg=e.msgimg.split(",");var a=[];e.msgimg.map(function(e,t){""!=e&&(a[t]="/public/upload/"+e)}),e.newimg=a,e.level=l.mlevel[e.mpd],e.msgtime=(0,p.default)(e.msgtime).fromNow()}),1==g.page?c=f:s.data.record.length>0?c=n.concat(f):m-=1,e.next=16,v({type:"updateState",payload:{messagelist:c,pagination:{current:m,pageSize:10,total:0}}});case 16:e.next=20;break;case 18:return e.next=20,v({type:"updateState",payload:{messagelist:[],pagination:{current:1,pageSize:10,total:0}}});case 20:case"end":return e.stop()}},e,this)}),addmessage:i.default.mark(function e(t,a){var r,n,u=t.payload,s=a.call,c=(a.out,a.put),o=a.select;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(function(e){return e.message});case 2:return r=e.sent,n=r.pagination,e.next=6,s(d.addmessage,{msgtype:u.msgtype,msgcontent:u.msgcontent,mid:286,msgid:(0,g.guid)(),msgtime:(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),room:1});case 6:return e.next=8,c({type:"getmessagelist",payload:{page:n.current,pageSize:n.pageSize}});case 8:case"end":return e.stop()}},e,this)})}},e.exports=t.default},2352:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mtype=["肆阅币","日学习卡","周学习卡","月学习卡","季学习卡","半年学习卡","年学习卡","双日卡","10次卡","20次卡","30次卡","50次卡"],t.mstate=["正常","欠费","停用"],t.ostate=["预订","正在使用","使用完成","过期"],t.astate=["会员变更","会员使用"],t.atype=["普通","管理员会员操作","储物柜","肆阅币消费","开门","会员购卡","会员充值","学习卡消费","开通高级会员"],t.placetype=["会员自助注册","中关村","-","001号馆"],t.odrtype=["试用","大众点评","美团","其他"],t.placelist=["","中关村","-","001号馆"],t.ltype=["","普通（大）","普通（小）","自助"],t.mlevel=["普通会员","管理员","小学","初中","高中","大学","硕士研究生","博士研究生","博士后","教授"],t.protype=["学习卡","学习周边"],t.discount=[1,.1,.95,.9,.85,.8,.75,.7,.65,.6],t.memberlevelupdate=[{cridit:"1000",level:3},{cridit:"2000",level:4},{cridit:"3000",level:5},{cridit:"6000",level:6},{cridit:"7000",level:7},{cridit:"8000",level:8},{cridit:"9000",level:9}]},3610:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updatecommunity=t.querycommunitylist=t.addcommunity=t.addmessage=t.delmessage=t.exquisitemessage=t.delcomment=t.getcommentlist=t.getmessagelist=void 0;var n=a(221),u=r(n),s=a(447),i=r(s),c=(t.getmessagelist=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/message/findmessagelist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.getcommentlist=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/message/findcomment",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.delcomment=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/message/delcomment",method:"post",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.exquisitemessage=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Message/"+t.msgid,method:"PUT",data:{msgtype:1}}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.delmessage=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/message/delmessage",method:"post",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.addmessage=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/message/addmessage",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.addcommunity=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Community",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querycommunitylist=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/message/findcommunitylist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.updatecommunity=function(){var e=(0,i.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Community/"+t.communityid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(104))}});