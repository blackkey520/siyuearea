webpackJsonp([0],{2352:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mtype=["肆阅币","日学习卡","周学习卡","月学习卡","季学习卡","半年学习卡","年学习卡","双日卡","10次卡","20次卡","30次卡","50次卡"],t.mstate=["正常","欠费","停用"],t.ostate=["预订","正在使用","使用完成","过期"],t.astate=["会员变更","会员使用"],t.atype=["普通","管理员会员操作","储物柜","肆阅币消费","开门","会员购卡","会员充值","学习卡消费","开通高级会员"],t.placetype=["会员自助注册","中关村","-","001号馆"],t.odrtype=["试用","大众点评","美团","其他"],t.placelist=["","中关村","-","001号馆"],t.ltype=["","普通（大）","普通（小）","自助"],t.mlevel=["普通会员","管理员","小学","初中","高中","大学","硕士研究生","博士研究生","博士后","教授"],t.protype=["学习卡","学习周边"],t.discount=[1,.1,.95,.9,.85,.8,.75,.7,.65,.6],t.memberlevelupdate=[{cridit:"1000",level:3},{cridit:"2000",level:4},{cridit:"3000",level:5},{cridit:"6000",level:6},{cridit:"7000",level:7},{cridit:"8000",level:8},{cridit:"9000",level:9}]},2620:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updates=t.querylist=t.addaccournt=void 0;var n=a(221),u=r(n),s=a(447),d=r(s),c=(t.addaccournt=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Accounts",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,d.default)(u.default.mark(function e(t,a,r){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/accounts/getaccountslist?page="+t+"&pageSize="+a,method:"POST",data:r}));case 1:case"end":return e.stop()}},e,this)}));return function(t,a,r){return e.apply(this,arguments)}}(),t.updates=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Accounts/"+t.oid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(104))},2672:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.paymoney=t.getusrmsg=t.updatememberdetail=t.update=t.loadmemberbyphone=t.loadmemeberdetail=t.loadmemeber=t.querylists=t.querylist=t.register=void 0;var n=a(221),u=r(n),s=a(447),d=r(s),c=(t.register=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Member",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/member/getmemberlist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylists=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/member/findmemberlist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemeber=function(){var e=(0,d.default)(u.default.mark(function e(t){var a,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id||0,r="/api/member/getsinglemember/"+a,e.abrupt("return",(0,c.request)({url:r,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemeberdetail=function(){var e=(0,d.default)(u.default.mark(function e(t){var a,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id||0,r="/api/restql/Base_MemberDetail",e.abrupt("return",(0,c.request)({url:r,data:{mid:a},method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemberbyphone=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Member",method:"GET",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Member/"+t.mid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.updatememberdetail=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_MemberDetail/"+t.mdid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.getusrmsg=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/wechat/getusr/"+t.code,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.paymoney=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/requestpayment/"+t.openid+"/"+t.money+"/"+t.ptype+"/"+t.attach,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(104))},2787:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.paytest=t.loadsingle=t.update=void 0;var n=a(221),u=r(n),s=a(447),d=r(s),c=(t.update=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Config/"+t.cid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadsingle=function(){var e=(0,d.default)(u.default.mark(function e(t){var a,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id||0,r="/api/restql/Base_Config/"+a,e.abrupt("return",(0,c.request)({url:r,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.paytest=function(){var e=(0,d.default)(u.default.mark(function e(t){var a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="/api/wechat/getusr/"+t.money,e.abrupt("return",(0,c.request)({url:a,method:"get"}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(104))},54:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(221),u=r(n),s=a(10),d=r(s),c=a(2672),o=a(2620),m=a(2787),i=a(3),p=r(i),l=a(144),f=a(2352);t.default={namespace:"member",state:{mobilemsg:"",loginuser:{},checkmember:{},memberlist:[],searchval:"",resultmsg:"您还不是我们的会员，请到店体验吧！我们的位置：北京市海淀区北四环西路68号左岸工社6层。",pagination:{current:1,pageSize:10,total:0}},reducers:{updateState:function(e,t){var a=t.payload;return(0,d.default)({},e,a)},loaddataSuccess:function(e,t){var a=t.payload.data;return(0,d.default)({},e,{memberlist:a.data.record,pagination:{current:t.payload.current,pageSize:t.payload.pageSize,total:a.data.totalRecord||0}})}},subscriptions:{},effects:{getusrbyphone:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=(a.out,a.put);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.loadmemberbyphone,{phonenum:n.phone});case 2:if(r=e.sent,!r.success||0===r.data.record.length){e.next=10;break}return e.next=6,d({type:"updateState",payload:{loginuser:{member:r.data.record[0]}}});case 6:return e.next=8,d(l.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 8:e.next=12;break;case 10:return e.next=12,d(l.routerRedux.push({pathname:"/mobile/result/false/认证失败"}));case 12:case"end":return e.stop()}},e,this)}),getusrmsg:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.getusrmsg,n);case 2:if(r=e.sent,!r.success){e.next=11;break}return e.next=6,d({type:"updateState",payload:{loginuser:r.data}});case 6:if(!r.data.ismember){e.next=9;break}return e.next=9,d(l.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 9:e.next=12;break;case 11:mobilemsg="系统出现问题，请稍后再试";case 12:case"end":return e.stop()}},e,this)}),register:u.default.mark(function(e,t){e.payload,t.call,t.put,t.select;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},c.register,this)}),getmemberlist:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.querylists,n);case 2:return r=e.sent,e.next=5,d({type:"loaddataSuccess",payload:{data:r,current:n.page,pageSize:n.pageSize,searchval:n.membercode}});case 5:case"end":return e.stop()}},e,this)}),loadmember:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.loadmemeber,n);case 2:if(!(r=e.sent)||!r.success){e.next=8;break}return r.data.mregisttime=(0,p.default)(r.data.mregisttime).format("YYYY-MM-DD HH:mm:ss"),r.data.mrtime=(0,p.default)(r.data.mrtime).format("YYYY-MM-DD HH:mm:ss"),e.next=8,d({type:"updateState",payload:{checkmember:r.data}});case 8:case"end":return e.stop()}},e,this)}),recharge:u.default.mark(function e(t,a){var r,n,s,d,i,l,h,y,b,Y,v,x,k,g,M=t.payload,w=a.call,D=(a.put,a.select);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.next=3,D(function(e){return e.member});case 3:return n=e.sent,s=n.checkmember,e.next=7,D(function(e){return e.productcard});case 7:return d=e.sent,i=d.productcardlist,l=M.callback,h={},e.next=13,w(m.loadsingle,{id:1});case 13:if(y=e.sent,h.mid=s.mid,b=(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),Y=s.mtype,v=null==s.mmoney?0:s.mmoney,"1"!==M.rechargetype){e.next=33;break}x=parseFloat(M.rechargevalue),x<=1e3&&(b=(0,p.default)().add(4,"month").format("YYYY-MM-DD 00:00:00")),1500==x&&2e3==x&&(b=(0,p.default)().add(6,"month").format("YYYY-MM-DD 00:00:00")),2500==x&&3e3==x&&(b=(0,p.default)().add(8,"month").format("YYYY-MM-DD 00:00:00")),3500==x&&4e3==x&&(b=(0,p.default)().add(10,"month").format("YYYY-MM-DD 00:00:00")),4500==x&&5e3==x&&(b=(0,p.default)().add(12,"month").format("YYYY-MM-DD 00:00:00")),h.amoney=parseFloat(v),h.asmoney=x+parseFloat(v),Y=0,v=parseFloat(v)+x,h.atype=1,h.adesc="管理员肆阅币充值->"+x+"元",e.next=76;break;case 33:if("2"!==M.rechargetype){e.next=76;break}k=0,e.t0=M.cardtype,e.next=1===e.t0?38:2===e.t0?40:3===e.t0?42:4===e.t0?44:5===e.t0?46:6===e.t0?48:7===e.t0?50:8===e.t0?52:9===e.t0?54:10===e.t0?56:11===e.t0?58:12===e.t0?60:62;break;case 38:return k=y.data.dayvalue,e.abrupt("break",64);case 40:return k=y.data.weekvalue,e.abrupt("break",64);case 42:return k=y.data.monthvalue,e.abrupt("break",64);case 44:return k=y.data.sessionvalue,e.abrupt("break",64);case 46:return k=y.data.hyearvalue,e.abrupt("break",64);case 48:return k=y.data.yearvalue,e.abrupt("break",64);case 50:return k=y.data.weekzmvalue,e.abrupt("break",64);case 52:return k=y.data.monthzmvalue,e.abrupt("break",64);case 54:return k=y.data.sessionzmvalue,e.abrupt("break",64);case 56:return k=y.data.weekzyvalue,e.abrupt("break",64);case 58:return k=y.data.monthzyvalue,e.abrupt("break",64);case 60:return k=y.data.sessionzyvalue,e.abrupt("break",64);case 62:return k=0,e.abrupt("break",64);case 64:1===M.cardtype&&(b=(0,p.default)(M.cardusedate).add(1,"days").format("YYYY-MM-DD 00:00:00")),2!==M.cardtype&&7!==M.cardtype||(b=(0,p.default)(M.cardusedate).add(7,"days").format("YYYY-MM-DD 00:00:00")),3===M.cardtype&&(b=(0,p.default)(M.cardusedate).add(1,"month").format("YYYY-MM-DD 00:00:00")),4===M.cardtype&&(b=(0,p.default)(M.cardusedate).add(3,"month").format("YYYY-MM-DD 00:00:00")),5===M.cardtype&&(b=(0,p.default)(M.cardusedate).add(6,"month").format("YYYY-MM-DD 00:00:00")),6===M.cardtype&&(b=(0,p.default)(M.cardusedate).add(12,"month").format("YYYY-MM-DD 00:00:00")),M.cardtype>7&&(b=(0,p.default)(M.cardusedate).add(12,"month").format("YYYY-MM-DD 00:00:00")),Y=parseInt(M.cardtype),h.atype=1,h.amoney=0,h.asmoney=0,h.adesc="管理员会员开通学习卡->"+f.mtype[M.cardtype];case 76:return h.atime=(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),h.astate=0,b=(0,p.default)(b).add(1,"days").format("YYYY-MM-DD 00:00:00"),e.next=81,w(c.update,{mid:s.mid,mregisttime:b,mtype:Y,mmoney:v});case 81:return r=e.sent,e.next=84,w(o.addaccournt,h);case 84:g=e.sent,l&&l(r);case 86:case"end":return e.stop()}},e,this)}),memberpause:u.default.mark(function e(t,a){var r,n,s,d,m=t.payload,i=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,n=m.callback,s={},s.mid=m.param.mid,s.atype=1,s.astate=0,s.atime=(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),2!=m.param.mstate){e.next=14;break}return e.next=10,i(c.update,{mid:m.param.mid,mstate:0,pausemark:null,mregisttime:(0,p.default)().add(m.param.pausemark+1,"days").format("YYYY-MM-DD HH:mm:ss")});case 10:r=e.sent,s.adesc="管理员会员恢复->为用户恢复"+m.param.pausemark+"天，恢复后时间 "+(0,p.default)().add(m.param.pausemark,"days").format("YYYY-MM-DD HH:mm:ss"),e.next=19;break;case 14:return d=(0,p.default)(m.param.mregisttime),e.next=17,i(c.update,{mid:m.param.mid,mstate:2,pausemark:(0,p.default)(m.param.mregisttime).diff((0,p.default)(),"days",!1)});case 17:r=e.sent,s.adesc="人工会员暂停->为用户暂停，会员剩余 "+(0,p.default)(m.param.mregisttime).diff((0,p.default)(),"days",!1)+" 天";case 19:return e.next=21,i(o.addaccournt,s);case 21:n&&n(r);case 22:case"end":return e.stop()}},e,this)}),extendovertime:u.default.mark(function e(t,a){var r,n,s,d,m=t.payload,i=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,n=m.callback,e.next=4,i(c.update,{mid:m.param.mid,mregisttime:(0,p.default)(m.param.mregisttime).add(m.extenddays,"days").format("YYYY-MM-DD HH:mm:ss")});case 4:return r=e.sent,s={},s.mid=m.param.mid,s.atype=1,s.astate=0,s.atime=(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),s.amoney=parseFloat(m.param.mmoney),s.asmoney=parseFloat(m.param.mmoney),s.adesc="管理员会员延期：->"+m.extenddays+"天，说明："+m.yqdesc,e.next=15,i(o.addaccournt,s);case 15:d=e.sent,n&&n(r);case 17:case"end":return e.stop()}},e,this)}),chargingmoney:u.default.mark(function e(t,a){var r,n,s,d,m=t.payload,i=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,n=m.callback,s={},s.mid=m.param.mid,s.atype=1,s.astate=1,s.atime=(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),s.amoney=parseFloat(m.param.mmoney),s.asmoney=parseFloat(m.param.mmoney)-parseFloat(m.kftext),s.adesc="管理员后台扣除肆阅币：->"+m.kftext+"元",e.next=12,i(o.addaccournt,s);case 12:return d=e.sent,e.next=15,i(c.update,{mid:m.param.mid,mmoney:m.param.mmoney-m.kftext});case 15:r=e.sent,n&&n(r);case 17:case"end":return e.stop()}},e,this)}),savemember:u.default.mark(function e(t,a){var r,n,s,d,o=t.payload,m=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,n=null,s=o.callback,delete o.callback,!o.param.id){e.next=13;break}return o.param.mid=o.param.id,o.param.mregisttime=(0,p.default)(o.param.mregisttime).format("YYYY-MM-DD HH:mm:ss"),delete o.param.id,o.param.mrtime=(0,p.default)(o.param.mrtime).format("YYYY-MM-DD HH:mm:ss"),e.next=10,m(c.update,o.param);case 10:r=e.sent,e.next=28;break;case 13:return o.param.membercode=Math.random().toString(20).substr(2),o.param.memberopenid="-",delete o.param.id,o.param.mmoney=0,o.param.memberprogramopenid="",o.param.mrtime=(0,p.default)().format("YYYY-MM-DD HH:mm:ss"),e.next=21,m(c.loadmemberbyphone,{phonenum:o.param.phonenum});case 21:if(d=e.sent,0===d.data.record.length){e.next=25;break}e.next=28;break;case 25:return e.next=27,m(c.register,o.param);case 27:r=e.sent;case 28:s&&s(r);case 29:case"end":return e.stop()}},e,this)})}},e.exports=t.default}});