webpackJsonp([0],{2356:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getusrmsg=t.update=t.loadmemeber=t.querylist=t.register=void 0;var n=r(213),u=a(n),s=r(431),c=a(s),i=(t.register=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)({url:"/api/restql/Base_Member",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)({url:"/api/restql/Base_Member",method:"GET",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemeber=function(){var e=(0,c.default)(u.default.mark(function e(t){var r,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id||0,a="/api/restql/Base_Member/"+r,e.abrupt("return",(0,i.request)({url:a,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)({url:"/api/restql/Base_Member/"+t.mid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.getusrmsg=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)({url:"/api/wechat/getusr/"+t.code,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r(99))},90:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(213),u=a(n),s=r(4),c=a(s),i=r(2356),o=(r(440),r(63),r(285)),l=(a(o),r(9)),d=a(l),p=r(923),m=r(136);t.default={namespace:"member",state:{mobilemsg:"",loginuser:{},checkmember:{},memberlist:[],pagination:{current:1,pageSize:10,total:0}},reducers:{updateState:function(e,t){var r=t.payload;return(0,c.default)({},e,r)},loaddataSuccess:function(e,t){var r=t.payload.data;return(0,c.default)({},e,{memberlist:r.data.record,pagination:{current:t.payload.current,pageSize:t.payload.pageSize,total:r.data.totalRecord||0}})}},subscriptions:{},effects:{getusrmsg:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(i.getusrmsg,n);case 2:if(a=e.sent,!a.success){e.next=11;break}return e.next=6,c({type:"updateState",payload:{loginuser:a.data}});case 6:if(!a.data.ismember){e.next=9;break}return e.next=9,c(m.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 9:e.next=12;break;case 11:mobilemsg="系统出现问题，请稍后再试";case 12:case"end":return e.stop()}},e,this)}),register:u.default.mark(function e(t,r){var a,n,s,c,o=t.payload,l=r.call,f=r.put,b=r.select;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={membercode:Math.random().toString(20).substr(2),memberopenid:o.userInfo.openid,mname:o.userInfo.nickname,phonenum:o.phone,mstate:1,mregisttime:(0,d.default)().format("YYYY-MM-DD HH:mm:ss"),mtype:1,mdesc:"",mmoney:0},e.next=3,b(function(e){return e.member});case 3:return n=e.sent,s=n.loginuser,e.next=7,l(i.register,a);case 7:if(c=e.sent,!c.success){e.next=17;break}return s.member=c.data,e.next=12,f({type:"updateState",payload:{loginuser:s}});case 12:return p.Toast.info("注册成功",1),e.next=15,f(m.routerRedux.push({pathname:"/mobile/"+o.routerid}));case 15:e.next=18;break;case 17:p.Toast.info("注册失败，请稍后再试",1);case 18:case"end":return e.stop()}},e,this)}),getmemberlist:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(i.querylist,n);case 2:return a=e.sent,e.next=5,c({type:"loaddataSuccess",payload:{data:a,current:n.page,pageSize:n.pageSize}});case 5:case"end":return e.stop()}},e,this)}),loadmember:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(i.loadmemeber,n);case 2:if(!(a=e.sent)||!a.success){e.next=6;break}return e.next=6,c({type:"updateState",payload:{checkmember:a.data}});case 6:case"end":return e.stop()}},e,this)}),recharge:u.default.mark(function e(t,r){var a,n,s,c,o=t.payload,l=r.call,p=(r.put,r.select);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,e.next=3,p(function(e){return e.member});case 3:return n=e.sent,s=n.checkmember,c=o.callback,s.mregisttime=(0,d.default)(s.mregisttime).format("YYYY-MM-DD HH:mm:ss"),s.mmoney=parseInt(s.mmoney)+parseInt(o.rechargevalue),delete s.nextOne,delete s.preOne,e.next=12,l(i.update,s);case 12:a=e.sent,c&&c(a);case 14:case"end":return e.stop()}},e,this)}),savemember:u.default.mark(function e(t,r){var a,n,s,c=t.payload,o=r.call;r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,n=null,s=c.callback,delete c.callback,null===c.param.id){e.next=12;break}return c.param.mid=c.param.id,c.param.mregisttime=(0,d.default)(c.param.mregisttime).format("YYYY-MM-DD HH:mm:ss"),delete c.param.id,e.next=9,o(i.update,c.param);case 9:a=e.sent,e.next=16;break;case 12:return delete c.param.id,e.next=15,o(i.register,c.param);case 15:a=e.sent;case 16:s&&s(a);case 17:case"end":return e.stop()}},e,this)})}},e.exports=t.default}});