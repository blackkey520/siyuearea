webpackJsonp([0],{1883:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mtype=["储值用户","日卡会员","周卡会员","月卡会员","季卡会员","半年卡会员","年卡会员","周卡（周末）","月卡（周末）","季卡（周末）","周卡（作业）","月卡（作业）","季卡（作业）"],t.mstate=["正常","欠费","停用"],t.ostate=["预订","正在使用","使用完成","过期"],t.astate=["会员变更","会员使用"],t.atype=["普通","充值","办卡","优惠卡","手动扣除","手动延期","消费"],t.placetype=["","中关村部","大望路部"],t.odrtype=["试用","大众点评","美团","其他"],t.placelist=["","中关村","大望路"]},2110:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updates=t.querylist=t.addaccournt=void 0;var n=a(187),u=r(n),s=a(369),d=r(s),c=(t.addaccournt=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Accounts",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,d.default)(u.default.mark(function e(t,a,r){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/accounts/getaccountslist?page="+t+"&pageSize="+a,method:"POST",data:r}));case 1:case"end":return e.stop()}},e,this)}));return function(t,a,r){return e.apply(this,arguments)}}(),t.updates=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Accounts/"+t.oid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(89))},2239:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.paymoney=t.getusrmsg=t.update=t.loadmemberbyphone=t.loadmemeber=t.querylists=t.querylist=t.register=void 0;var n=a(187),u=r(n),s=a(369),d=r(s),c=(t.register=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Member",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/member/getmemberlist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylists=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/member/findmemberlist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemeber=function(){var e=(0,d.default)(u.default.mark(function e(t){var a,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id||0,r="/api/member/getsinglemember/"+a,e.abrupt("return",(0,c.request)({url:r,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemberbyphone=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Member",method:"GET",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Member/"+t.mid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.getusrmsg=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/wechat/getusr/"+t.code,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.paymoney=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/requestpayment/"+t.openid+"/"+t.money+"/"+t.ptype+"/"+t.attach,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(89))},2250:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.paytest=t.loadsingle=t.update=void 0;var n=a(187),u=r(n),s=a(369),d=r(s),c=(t.update=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)({url:"/api/restql/Base_Config/"+t.cid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadsingle=function(){var e=(0,d.default)(u.default.mark(function e(t){var a,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id||0,r="/api/restql/Base_Config/"+a,e.abrupt("return",(0,c.request)({url:r,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.paytest=function(){var e=(0,d.default)(u.default.mark(function e(t){var a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="/api/wechat/getusr/"+t.money,e.abrupt("return",(0,c.request)({url:a,method:"get"}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a(89))},50:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(187),u=r(n),s=a(1),d=r(s),c=a(2239),m=a(2110),o=a(2250),p=a(8),i=r(p),l=a(123),f=a(1883),y=a(56);t.default={namespace:"member",state:{mobilemsg:"",loginuser:{},checkmember:{},memberlist:[],searchval:"",resultmsg:"您还不是我们的会员，请到店体验吧！我们的位置：北京市海淀区北四环西路68号左岸工社6层。",pagination:{current:1,pageSize:10,total:0}},reducers:{updateState:function(e,t){var a=t.payload;return(0,d.default)({},e,a)},loaddataSuccess:function(e,t){var a=t.payload.data;return(0,d.default)({},e,{memberlist:a.data.record,pagination:{current:t.payload.current,pageSize:t.payload.pageSize,total:a.data.totalRecord||0}})}},subscriptions:{},effects:{getusrbyphone:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=(a.out,a.put);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.loadmemberbyphone,{phonenum:n.phone});case 2:if(r=e.sent,!r.success||0===r.data.record.length){e.next=10;break}return e.next=6,d({type:"updateState",payload:{loginuser:{member:r.data.record[0]}}});case 6:return e.next=8,d(l.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 8:e.next=12;break;case 10:return e.next=12,d(l.routerRedux.push({pathname:"/mobile/result/false/认证失败"}));case 12:case"end":return e.stop()}},e,this)}),getusrmsg:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.getusrmsg,n);case 2:if(r=e.sent,!r.success){e.next=11;break}return e.next=6,d({type:"updateState",payload:{loginuser:r.data}});case 6:if(!r.data.ismember){e.next=9;break}return e.next=9,d(l.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 9:e.next=12;break;case 11:mobilemsg="系统出现问题，请稍后再试";case 12:case"end":return e.stop()}},e,this)}),register:u.default.mark(function(e,t){var a,r,n,s,d,m=e.payload,o=t.call,p=t.put,f=t.select;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(function(e){return e.member});case 2:return a=e.sent,r=a.loginuser,n=null,e.next=7,o(c.loadmemberbyphone,{phonenum:m.phone});case 7:if(s=e.sent,0===s.data.record.length){e.next=23;break}return d=s.data.record[0],d.memberopenid=m.userInfo.openid,d.mregisttime=(0,i.default)(d.mregisttime).format("YYYY-MM-DD HH:mm:ss"),d.mrtime=(0,i.default)().format("YYYY-MM-DD HH:mm:ss"),e.next=15,o(c.update,d);case 15:return n=e.sent,r.member=d,e.next=19,p({type:"updateState",payload:{loginuser:r}});case 19:return e.next=21,p(l.routerRedux.push({pathname:"/mobile/"+m.routerid}));case 21:e.next=25;break;case 23:return e.next=25,p(l.routerRedux.push({pathname:"/mobile/result/false/认证失败"}));case 25:case"end":return e.stop()}},c.register,this)}),getmemberlist:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.querylists,n);case 2:return r=e.sent,e.next=5,d({type:"loaddataSuccess",payload:{data:r,current:n.page,pageSize:n.pageSize,searchval:n.membercode}});case 5:case"end":return e.stop()}},e,this)}),loadmember:u.default.mark(function e(t,a){var r,n=t.payload,s=a.call,d=a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.loadmemeber,n);case 2:if(!(r=e.sent)||!r.success){e.next=8;break}return r.data.mregisttime=(0,i.default)(r.data.mregisttime).format("YYYY-MM-DD HH:mm:ss"),r.data.mrtime=(0,i.default)(r.data.mrtime).format("YYYY-MM-DD HH:mm:ss"),e.next=8,d({type:"updateState",payload:{checkmember:r.data}});case 8:case"end":return e.stop()}},e,this)}),recharge:u.default.mark(function e(t,a){var r,n,s,d,p,l,y,h,b,Y,x,v,g,k,M,w,D=t.payload,H=a.call,q=(a.put,a.select);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.next=3,q(function(e){return e.member});case 3:return n=e.sent,s=n.checkmember,e.next=7,q(function(e){return e.productcard});case 7:return d=e.sent,p=d.productcardlist,l=D.callback,y={},e.next=13,H(o.loadsingle,{id:1});case 13:if(h=e.sent,y.mid=s.mid,b=(0,i.default)().format("YYYY-MM-DD HH:mm:ss"),Y=s.mtype,x=null==s.mmoney?0:s.mmoney,v=s.mpd,"1"!==D.rechargetype){e.next=34;break}g=parseInt(D.rechargevalue),g<=500&&(b=(0,i.default)().add(1,"month").format("YYYY-MM-DD HH:mm:ss")),g>=500&&g<1e3&&(b=(0,i.default)().add(2,"month").format("YYYY-MM-DD HH:mm:ss")),g>=1e3&&g<2e3&&(b=(0,i.default)().add(3,"month").format("YYYY-MM-DD HH:mm:ss")),g>=2e3&&g<5e3&&(b=(0,i.default)().add(5,"month").format("YYYY-MM-DD HH:mm:ss")),g>=5e3&&(b=(0,i.default)().add(12,"month").format("YYYY-MM-DD HH:mm:ss")),y.amoney=parseInt(x),y.asmoney=g+parseInt(x),Y=0,x=parseInt(x)+g,y.atype=1,y.adesc="会员充值",e.next=85;break;case 34:if("2"!==D.rechargetype){e.next=78;break}k=0,e.t0=D.cardtype,e.next=1===e.t0?39:2===e.t0?41:3===e.t0?43:4===e.t0?45:5===e.t0?47:6===e.t0?49:7===e.t0?51:8===e.t0?53:9===e.t0?55:10===e.t0?57:11===e.t0?59:12===e.t0?61:63;break;case 39:return k=h.data.dayvalue,e.abrupt("break",65);case 41:return k=h.data.weekvalue,e.abrupt("break",65);case 43:return k=h.data.monthvalue,e.abrupt("break",65);case 45:return k=h.data.sessionvalue,e.abrupt("break",65);case 47:return k=h.data.hyearvalue,e.abrupt("break",65);case 49:return k=h.data.yearvalue,e.abrupt("break",65);case 51:return k=h.data.weekzmvalue,e.abrupt("break",65);case 53:return k=h.data.monthzmvalue,e.abrupt("break",65);case 55:return k=h.data.sessionzmvalue,e.abrupt("break",65);case 57:return k=h.data.weekzyvalue,e.abrupt("break",65);case 59:return k=h.data.monthzyvalue,e.abrupt("break",65);case 61:return k=h.data.sessionzyvalue,e.abrupt("break",65);case 63:return k=0,e.abrupt("break",65);case 65:1===D.cardtype&&(b=(0,i.default)(D.cardusedate).add(1,"days").format("YYYY-MM-DD HH:mm:ss")),2!==D.cardtype&&7!==D.cardtype&&10!==D.cardtype||(b=(0,i.default)(D.cardusedate).add(7,"days").format("YYYY-MM-DD HH:mm:ss")),3!==D.cardtype&&8!==D.cardtype&&11!==D.cardtype||(b=(0,i.default)(D.cardusedate).add(1,"month").format("YYYY-MM-DD HH:mm:ss")),4!==D.cardtype&&9!==D.cardtype&&12!==D.cardtype||(b=(0,i.default)(D.cardusedate).add(3,"month").format("YYYY-MM-DD HH:mm:ss")),5===D.cardtype&&(b=(0,i.default)(D.cardusedate).add(6,"month").format("YYYY-MM-DD HH:mm:ss")),6===D.cardtype&&(b=(0,i.default)(D.cardusedate).add(12,"month").format("YYYY-MM-DD HH:mm:ss")),Y=parseInt(D.cardtype),y.atype=2,y.amoney=0,y.asmoney=0,y.adesc=f.mtype[D.cardtype],e.next=85;break;case 78:M=p.find(function(e){return e.pcid===parseInt(D.pctype)}),v=M.pcid,b=(0,i.default)(M.etime).format("YYYY-MM-DD HH:mm:ss"),y.atype=3,y.amoney=0,y.asmony=0,y.adesc=M.pcname;case 85:return y.atime=(0,i.default)().format("YYYY-MM-DD HH:mm:ss"),y.astate=0,b=(0,i.default)(b).add(1,"days").format("YYYY-MM-DD HH:mm:ss"),e.next=90,H(c.update,{mid:s.mid,mregisttime:b,mtype:Y,mmoney:x,mpd:v});case 90:return r=e.sent,e.next=93,H(m.addaccournt,y);case 93:w=e.sent,l&&l(r);case 95:case"end":return e.stop()}},e,this)}),extendovertime:u.default.mark(function e(t,a){var r,n,s,d,o=t.payload,p=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,n=o.callback,e.next=4,p(c.update,{mid:o.param.mid,mregisttime:(0,i.default)(o.param.mregisttime).add(o.extenddays,"days").format("YYYY-MM-DD HH:mm:ss")});case 4:return r=e.sent,s={},s.mid=o.param.mid,s.atype=5,s.astate=0,s.atime=(0,i.default)().format("YYYY-MM-DD HH:mm:ss"),s.amoney=parseInt(o.param.mmoney),s.asmoney=parseInt(o.param.mmoney),s.adesc="手动延期："+o.extenddays+"天--\x3e说明："+o.yqdesc,e.next=15,p(m.addaccournt,s);case 15:d=e.sent,n&&n(r);case 17:case"end":return e.stop()}},e,this)}),chargingmoney:u.default.mark(function e(t,a){var r,n,s,d,o=t.payload,p=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,n=o.callback,s={},s.mid=o.param.mid,s.atype=4,s.astate=1,s.atime=(0,i.default)().format("YYYY-MM-DD HH:mm:ss"),s.amoney=parseInt(o.param.mmoney),s.asmoney=parseInt(o.param.mmoney)-parseInt(o.kftext),s.adesc="手动扣费",e.next=12,p(m.addaccournt,s);case 12:return d=e.sent,e.next=15,p(c.update,{mid:o.param.mid,mmoney:o.param.mmoney-o.kftext});case 15:r=e.sent,n&&n(r);case 17:case"end":return e.stop()}},e,this)}),savemember:u.default.mark(function e(t,a){var r,n,s,d,m=t.payload,o=a.call;a.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,n=null,s=m.callback,delete m.callback,m.param.mpd=0,!m.param.id){e.next=14;break}return m.param.mid=m.param.id,m.param.mregisttime=(0,i.default)(m.param.mregisttime).format("YYYY-MM-DD HH:mm:ss"),delete m.param.id,m.param.mrtime=(0,i.default)(m.param.mrtime).format("YYYY-MM-DD HH:mm:ss"),e.next=11,o(c.update,m.param);case 11:r=e.sent,e.next=30;break;case 14:return m.param.membercode=Math.random().toString(20).substr(2),m.param.memberopenid="-",delete m.param.id,m.param.mmoney=0,m.param.memberprogramopenid="",m.param.mrtime=(0,i.default)().format("YYYY-MM-DD HH:mm:ss"),e.next=22,o(c.loadmemberbyphone,{phonenum:m.param.phonenum});case 22:if(d=e.sent,0===d.data.record.length){e.next=27;break}y.message.error("电话号码已存在"),e.next=30;break;case 27:return e.next=29,o(c.register,m.param);case 29:r=e.sent;case 30:s&&s(r);case 31:case"end":return e.stop()}},e,this)})}},e.exports=t.default}});