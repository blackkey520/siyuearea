webpackJsonp([0],{1882:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mtype=["储值用户","日卡会员","周卡会员","月卡会员","季卡会员","周卡（周末）","月卡（周末）","季卡（周末）","周卡（作业）","月卡（作业）","季卡（作业）"],t.mstate=["正常","欠费","停用"],t.ostate=["预定","正在使用","使用完成","过期"],t.astate=["收入","消费"],t.atype=["普通","充值","办卡","优惠卡"]},2196:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updates=t.querylist=t.addaccournt=void 0;var n=r(186),u=a(n),s=r(369),c=a(s),d=(t.addaccournt=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/restql/Base_Accounts",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,c.default)(u.default.mark(function e(t,r,a){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/accounts/getaccountslist?page="+t+"&pageSize="+r,method:"POST",data:a}));case 1:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}(),t.updates=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/restql/Base_Accounts/"+t.oid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r(89))},2240:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.paytest=t.loadsingle=t.update=void 0;var n=r(186),u=a(n),s=r(369),c=a(s),d=(t.update=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/restql/Base_Config/"+t.cid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadsingle=function(){var e=(0,c.default)(u.default.mark(function e(t){var r,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id||0,a="/api/restql/Base_Config/"+r,e.abrupt("return",(0,d.request)({url:a,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.paytest=function(){var e=(0,c.default)(u.default.mark(function e(t){var r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/api/wechat/getusr/"+t.money,e.abrupt("return",(0,d.request)({url:r,method:"get"}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r(89))},2241:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.paymoney=t.getusrmsg=t.update=t.loadmemberbyphone=t.loadmemeber=t.querylists=t.querylist=t.register=void 0;var n=r(186),u=a(n),s=r(369),c=a(s),d=(t.register=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/restql/Base_Member",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylist=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/member/getmemberlist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.querylists=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/member/findmemberlist",method:"POST",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemeber=function(){var e=(0,c.default)(u.default.mark(function e(t){var r,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id||0,a="/api/member/getsinglemember/"+r,e.abrupt("return",(0,d.request)({url:a,method:"get"}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.loadmemberbyphone=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/restql/Base_Member",method:"GET",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/restql/Base_Member/"+t.mid,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.getusrmsg=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/api/wechat/getusr/"+t.code,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.paymoney=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:"/requestpayment/"+t.openid+"/"+t.money+"/"+t.ptype+"/"+t.attach,method:"get"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r(89))},50:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(186),u=a(n),s=r(1),c=a(s),d=r(2241),o=r(2196),p=r(2240),i=r(8),l=a(i),m=r(123),f=r(1882);t.default={namespace:"member",state:{mobilemsg:"",loginuser:{},checkmember:{},memberlist:[],resultmsg:"您还不是我们的会员，请到店体验吧！我们的位置：北京市海淀区北四环西路68号左岸工社6层。",pagination:{current:1,pageSize:10,total:0}},reducers:{updateState:function(e,t){var r=t.payload;return(0,c.default)({},e,r)},loaddataSuccess:function(e,t){var r=t.payload.data;return(0,c.default)({},e,{memberlist:r.data.record,pagination:{current:t.payload.current,pageSize:t.payload.pageSize,total:r.data.totalRecord||0}})}},subscriptions:{},effects:{getusrbyphone:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=(r.out,r.put);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(d.loadmemberbyphone,{phonenum:n.phone});case 2:if(a=e.sent,!a.success||0===a.data.record.length){e.next=10;break}return e.next=6,c({type:"updateState",payload:{loginuser:{member:a.data.record[0]}}});case 6:return e.next=8,c(m.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 8:e.next=12;break;case 10:return e.next=12,c(m.routerRedux.push({pathname:"/mobile/result/false/认证失败"}));case 12:case"end":return e.stop()}},e,this)}),getusrmsg:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(d.getusrmsg,n);case 2:if(a=e.sent,!a.success){e.next=11;break}return e.next=6,c({type:"updateState",payload:{loginuser:a.data}});case 6:if(!a.data.ismember){e.next=9;break}return e.next=9,c(m.routerRedux.push({pathname:"/mobile/"+n.routerid}));case 9:e.next=12;break;case 11:mobilemsg="系统出现问题，请稍后再试";case 12:case"end":return e.stop()}},e,this)}),register:u.default.mark(function(e,t){var r,a,n,s,c,o=e.payload,p=t.call,i=t.put,f=t.select;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(function(e){return e.member});case 2:return r=e.sent,a=r.loginuser,n=null,e.next=7,p(d.loadmemberbyphone,{phonenum:o.phone});case 7:if(s=e.sent,0===s.data.record.length){e.next=22;break}return c=s.data.record[0],c.memberopenid=o.userInfo.openid,c.mregisttime=(0,l.default)(c.mregisttime).format("YYYY-MM-DD HH:mm:ss"),e.next=14,p(d.update,c);case 14:return n=e.sent,a.member=c,e.next=18,i({type:"updateState",payload:{loginuser:a}});case 18:return e.next=20,i(m.routerRedux.push({pathname:"/mobile/"+o.routerid}));case 20:e.next=24;break;case 22:return e.next=24,i(m.routerRedux.push({pathname:"/mobile/result/false/认证失败"}));case 24:case"end":return e.stop()}},d.register,this)}),getmemberlist:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(d.querylists,n);case 2:return a=e.sent,e.next=6,c({type:"loaddataSuccess",payload:{data:a,current:n.page,pageSize:n.pageSize}});case 6:case"end":return e.stop()}},e,this)}),loadmember:u.default.mark(function e(t,r){var a,n=t.payload,s=r.call,c=r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(d.loadmemeber,n);case 2:if(!(a=e.sent)||!a.success){e.next=6;break}return e.next=6,c({type:"updateState",payload:{checkmember:a.data}});case 6:case"end":return e.stop()}},e,this)}),recharge:u.default.mark(function e(t,r){var a,n,s,c,i,m,h,b,y,v,x,g,k,Y=t.payload,w=r.call,M=(r.put,r.select);return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,e.next=3,M(function(e){return e.member});case 3:return n=e.sent,s=n.checkmember,e.next=7,M(function(e){return e.productcard});case 7:return c=e.sent,i=c.productcardlist,m=Y.callback,h={},e.next=13,w(p.loadsingle,{id:1});case 13:if(b=e.sent,h.mid=s.mid,y=(0,l.default)().format("YYYY-MM-DD HH:mm:ss"),"1"!==Y.rechargetype){e.next=32;break}v=parseInt(Y.rechargevalue),v<=500&&(y=(0,l.default)().add(1,"month").format("YYYY-MM-DD HH:mm:ss")),v>=500&&v<1e3&&(y=(0,l.default)().add(2,"month").format("YYYY-MM-DD HH:mm:ss")),v>1e3&&v<2e3&&(y=(0,l.default)().add(3,"month").format("YYYY-MM-DD HH:mm:ss")),v>=2e3&&v<5e3&&(y=(0,l.default)().add(5,"month").format("YYYY-MM-DD HH:mm:ss")),v>5e3&&(y=(0,l.default)().add(12,"month").format("YYYY-MM-DD HH:mm:ss")),s.mtype=0,s.mregisttime=y,s.mmoney=parseInt(s.mmoney)+v,h.atype=1,h.amoney=parseInt(Y.rechargevalue),h.asmoney=parseInt(Y.rechargevalue),h.adesc="会员充值",e.next=78;break;case 32:if("2"!==Y.rechargetype){e.next=71;break}x=0,e.t0=Y.cardtype,e.next=1===e.t0?37:2===e.t0?39:3===e.t0?41:4===e.t0?43:5===e.t0?45:6===e.t0?47:7===e.t0?49:8===e.t0?51:9===e.t0?53:10===e.t0?55:57;break;case 37:return x=b.data.dayvalue,e.abrupt("break",59);case 39:return x=b.data.weekvalue,e.abrupt("break",59);case 41:return x=b.data.monthvalue,e.abrupt("break",59);case 43:return x=b.data.sessionvalue,e.abrupt("break",59);case 45:return x=b.data.weekzmvalue,e.abrupt("break",59);case 47:return x=b.data.monthzmvalue,e.abrupt("break",59);case 49:return x=b.data.sessionzmvalue,e.abrupt("break",59);case 51:return x=b.data.weekzyvalue,e.abrupt("break",59);case 53:return x=b.data.monthzyvalue,e.abrupt("break",59);case 55:return x=b.data.sessionzyvalue,e.abrupt("break",59);case 57:return x=0,e.abrupt("break",59);case 59:1===Y.cardtype&&(y=(0,l.default)(Y.cardusedate).add(1,"days").format("YYYY-MM-DD HH:mm:ss")),2!==Y.cardtype&&5!==Y.cardtype&&8!==Y.cardtype||(y=(0,l.default)(Y.cardusedate).add(7,"days").format("YYYY-MM-DD HH:mm:ss")),3!==Y.cardtype&&6!==Y.cardtype&&9!==Y.cardtype||(y=(0,l.default)(Y.cardusedate).add(1,"month").format("YYYY-MM-DD HH:mm:ss")),4!==Y.cardtype&&7!==Y.cardtype&&10!==Y.cardtype||(y=(0,l.default)(Y.cardusedate).add(3,"month").format("YYYY-MM-DD HH:mm:ss")),s.mregisttime=y,s.mtype=parseInt(Y.cardtype),h.atype=2,h.amoney=x,h.asmoney=x,h.adesc=f.mtype[Y.cardtype],e.next=78;break;case 71:g=i.find(function(e){return e.pcid===parseInt(Y.pctype)}),s.mpd=g.pcid,s.mregisttime=(0,l.default)(g.etime).format("YYYY-MM-DD HH:mm:ss"),h.atype=3,h.amoney=g.value,h.asmoney=g.value,h.adesc=g.pcname;case 78:return h.atime=(0,l.default)().format("YYYY-MM-DD HH:mm:ss"),h.astate=0,delete s.pcname,delete s.btime,delete s.etime,delete s.isused,delete s.pcdesc,delete s.value,e.next=88,w(d.update,s);case 88:return a=e.sent,e.next=91,w(o.addaccournt,h);case 91:k=e.sent,m&&m(a);case 93:case"end":return e.stop()}},e,this)}),extendovertime:u.default.mark(function e(t,r){var a,n,s=t.payload,c=r.call;r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,n=s.callback,delete s.callback,delete s.param.btime,delete s.param.etime,delete s.param.isused,delete s.param.pcdesc,delete s.param.pcname,delete s.param.value,s.param.mregisttime=(0,l.default)(s.param.mregisttime).add(s.extenddays,"days").format("YYYY-MM-DD HH:mm:ss"),e.next=12,c(d.update,s.param);case 12:a=e.sent,n&&n(a);case 14:case"end":return e.stop()}},e,this)}),savemember:u.default.mark(function e(t,r){var a,n,s,c=t.payload,o=r.call;r.put;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,n=null,s=c.callback,delete c.callback,c.param.mpd=0,!c.param.id){e.next=13;break}return c.param.mid=c.param.id,c.param.mregisttime=(0,l.default)(c.param.mregisttime).format("YYYY-MM-DD HH:mm:ss"),delete c.param.id,e.next=10,o(d.update,c.param);case 10:a=e.sent,e.next=19;break;case 13:return c.param.membercode=Math.random().toString(20).substr(2),c.param.memberopenid="-",delete c.param.id,e.next=18,o(d.register,c.param);case 18:a=e.sent;case 19:s&&s(a);case 20:case"end":return e.stop()}},e,this)})}},e.exports=t.default}});